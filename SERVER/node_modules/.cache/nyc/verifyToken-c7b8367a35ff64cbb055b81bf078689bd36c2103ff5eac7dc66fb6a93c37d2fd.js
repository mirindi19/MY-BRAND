function cov_1ed3lubjti(){var path="E:\\andela\\New Andela\\node_mongo_tutorial\\src\\middlewares\\verifyToken.js";var hash="e0a10c3f6af114ed2f89aff59e99d3945daf6676";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"E:\\andela\\New Andela\\node_mongo_tutorial\\src\\middlewares\\verifyToken.js",statementMap:{"0":{start:{line:1,column:12},end:{line:1,column:35}},"1":{start:{line:2,column:15},end:{line:2,column:32}},"2":{start:{line:3,column:0},end:{line:3,column:16}},"3":{start:{line:4,column:20},end:{line:35,column:1}},"4":{start:{line:7,column:16},end:{line:7,column:31}},"5":{start:{line:8,column:2},end:{line:23,column:3}},"6":{start:{line:9,column:4},end:{line:18,column:7}},"7":{start:{line:10,column:6},end:{line:14,column:7}},"8":{start:{line:11,column:8},end:{line:13,column:11}},"9":{start:{line:15,column:6},end:{line:17,column:7}},"10":{start:{line:16,column:8},end:{line:16,column:15}},"11":{start:{line:20,column:4},end:{line:22,column:7}},"12":{start:{line:37,column:0},end:{line:37,column:29}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:4,column:20},end:{line:4,column:21}},loc:{start:{line:4,column:46},end:{line:35,column:1}},line:4},"1":{name:"(anonymous_1)",decl:{start:{line:9,column:45},end:{line:9,column:46}},loc:{start:{line:9,column:68},end:{line:18,column:5}},line:9}},branchMap:{"0":{loc:{start:{line:8,column:2},end:{line:23,column:3}},type:"if",locations:[{start:{line:8,column:2},end:{line:23,column:3}},{start:{line:8,column:2},end:{line:23,column:3}}],line:8},"1":{loc:{start:{line:10,column:6},end:{line:14,column:7}},type:"if",locations:[{start:{line:10,column:6},end:{line:14,column:7}},{start:{line:10,column:6},end:{line:14,column:7}}],line:10},"2":{loc:{start:{line:15,column:6},end:{line:17,column:7}},type:"if",locations:[{start:{line:15,column:6},end:{line:17,column:7}},{start:{line:15,column:6},end:{line:17,column:7}}],line:15}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0},f:{"0":0,"1":0},b:{"0":[0,0],"1":[0,0],"2":[0,0]},inputSourceMap:{version:3,names:["jwt","require","dotenv","config","verifyToken","req","res","next","token","cookies","verify","err","decodedtoken","status","json","module","exports"],sourceRoot:"E:\\andela\\New Andela\\node_mongo_tutorial\\src\\middlewares\\",sources:["verifyToken.js"],sourcesContent:["const jwt=require(\"jsonwebtoken\");\r\nconst dotenv=require(\"dotenv\");\r\ndotenv.config();\r\n\r\nconst verifyToken=async(req, res, next)=>{\r\n// const token=req.headers['token']\r\n//const token=authHeader && authHeader.split('')[1]\r\nconst token = req.cookies.jwt\r\nif(token){\r\n    jwt.verify(token,'mirinditokensecrete',(err,decodedtoken)=>{\r\n        if(err){\r\n            res.status(401).json({\"Error\":\"Please Login First !!!\"})\r\n        }\r\n        if(decodedtoken){\r\n             next()\r\n        }\r\n    })\r\n}else{\r\n    res.status(406).json({\"Message\":\"Please Login First !!!\"})\r\n }\r\n// if (!token) {\r\n//     return res.status(404).send(\"A token is required for authentication\");\r\n//   }\r\n//   try {\r\n//     const decoded = jwt.verify(token, process.env.JWT_SECRET);\r\n//     req.user = decoded;\r\n//     // console.log(req.user)\r\n//   } catch (err) {\r\n//     return res.status(401).send(\"Invalid Token\");\r\n//   }\r\n//   return next();\r\n\r\n}\r\nmodule.exports=verifyToken;\r\n"],mappings:"AAAA,MAAMA,GAAG,GAACC,OAAO,CAAC,cAAc,CAAC;AACjC,MAAMC,MAAM,GAACD,OAAO,CAAC,QAAQ,CAAC;AAC9BC,MAAM,CAACC,MAAM,EAAE;AAEf,MAAMC,WAAW,GAAC,OAAMC,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAG;EACzC;EACA;EACA,MAAMC,KAAK,GAAGH,GAAG,CAACI,OAAO,CAACT,GAAG;EAC7B,IAAGQ,KAAK,EAAC;IACLR,GAAG,CAACU,MAAM,CAACF,KAAK,EAAC,qBAAqB,EAAC,CAACG,GAAG,EAACC,YAAY,KAAG;MACvD,IAAGD,GAAG,EAAC;QACHL,GAAG,CAACO,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;UAAC,OAAO,EAAC;QAAwB,CAAC,CAAC;MAC5D;MACA,IAAGF,YAAY,EAAC;QACXL,IAAI,EAAE;MACX;IACJ,CAAC,CAAC;EACN,CAAC,MAAI;IACDD,GAAG,CAACO,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAC,SAAS,EAAC;IAAwB,CAAC,CAAC;EAC7D;EACD;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;AAEA,CAAC;;AACDC,MAAM,CAACC,OAAO,GAACZ,WAAW"},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"e0a10c3f6af114ed2f89aff59e99d3945daf6676"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1ed3lubjti=function(){return actualCoverage;};}return actualCoverage;}cov_1ed3lubjti();const jwt=(cov_1ed3lubjti().s[0]++,require("jsonwebtoken"));const dotenv=(cov_1ed3lubjti().s[1]++,require("dotenv"));cov_1ed3lubjti().s[2]++;dotenv.config();cov_1ed3lubjti().s[3]++;const verifyToken=async(req,res,next)=>{cov_1ed3lubjti().f[0]++;// const token=req.headers['token']
//const token=authHeader && authHeader.split('')[1]
const token=(cov_1ed3lubjti().s[4]++,req.cookies.jwt);cov_1ed3lubjti().s[5]++;if(token){cov_1ed3lubjti().b[0][0]++;cov_1ed3lubjti().s[6]++;jwt.verify(token,'mirinditokensecrete',(err,decodedtoken)=>{cov_1ed3lubjti().f[1]++;cov_1ed3lubjti().s[7]++;if(err){cov_1ed3lubjti().b[1][0]++;cov_1ed3lubjti().s[8]++;res.status(401).json({"Error":"Please Login First !!!"});}else{cov_1ed3lubjti().b[1][1]++;}cov_1ed3lubjti().s[9]++;if(decodedtoken){cov_1ed3lubjti().b[2][0]++;cov_1ed3lubjti().s[10]++;next();}else{cov_1ed3lubjti().b[2][1]++;}});}else{cov_1ed3lubjti().b[0][1]++;cov_1ed3lubjti().s[11]++;res.status(406).json({"Message":"Please Login First !!!"});}// if (!token) {
//     return res.status(404).send("A token is required for authentication");
//   }
//   try {
//     const decoded = jwt.verify(token, process.env.JWT_SECRET);
//     req.user = decoded;
//     // console.log(req.user)
//   } catch (err) {
//     return res.status(401).send("Invalid Token");
//   }
//   return next();
};cov_1ed3lubjti().s[12]++;module.exports=verifyToken;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJqd3QiLCJyZXF1aXJlIiwiZG90ZW52IiwiY29uZmlnIiwidmVyaWZ5VG9rZW4iLCJyZXEiLCJyZXMiLCJuZXh0IiwidG9rZW4iLCJjb29raWVzIiwidmVyaWZ5IiwiZXJyIiwiZGVjb2RlZHRva2VuIiwic3RhdHVzIiwianNvbiIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6IkU6XFxhbmRlbGFcXE5ldyBBbmRlbGFcXG5vZGVfbW9uZ29fdHV0b3JpYWxcXHNyY1xcbWlkZGxld2FyZXNcXCIsInNvdXJjZXMiOlsidmVyaWZ5VG9rZW4uanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3Qgand0PXJlcXVpcmUoXCJqc29ud2VidG9rZW5cIik7XHJcbmNvbnN0IGRvdGVudj1yZXF1aXJlKFwiZG90ZW52XCIpO1xyXG5kb3RlbnYuY29uZmlnKCk7XHJcblxyXG5jb25zdCB2ZXJpZnlUb2tlbj1hc3luYyhyZXEsIHJlcywgbmV4dCk9PntcclxuLy8gY29uc3QgdG9rZW49cmVxLmhlYWRlcnNbJ3Rva2VuJ11cclxuLy9jb25zdCB0b2tlbj1hdXRoSGVhZGVyICYmIGF1dGhIZWFkZXIuc3BsaXQoJycpWzFdXHJcbmNvbnN0IHRva2VuID0gcmVxLmNvb2tpZXMuand0XHJcbmlmKHRva2VuKXtcclxuICAgIGp3dC52ZXJpZnkodG9rZW4sJ21pcmluZGl0b2tlbnNlY3JldGUnLChlcnIsZGVjb2RlZHRva2VuKT0+e1xyXG4gICAgICAgIGlmKGVycil7XHJcbiAgICAgICAgICAgIHJlcy5zdGF0dXMoNDAxKS5qc29uKHtcIkVycm9yXCI6XCJQbGVhc2UgTG9naW4gRmlyc3QgISEhXCJ9KVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZihkZWNvZGVkdG9rZW4pe1xyXG4gICAgICAgICAgICAgbmV4dCgpXHJcbiAgICAgICAgfVxyXG4gICAgfSlcclxufWVsc2V7XHJcbiAgICByZXMuc3RhdHVzKDQwNikuanNvbih7XCJNZXNzYWdlXCI6XCJQbGVhc2UgTG9naW4gRmlyc3QgISEhXCJ9KVxyXG4gfVxyXG4vLyBpZiAoIXRva2VuKSB7XHJcbi8vICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLnNlbmQoXCJBIHRva2VuIGlzIHJlcXVpcmVkIGZvciBhdXRoZW50aWNhdGlvblwiKTtcclxuLy8gICB9XHJcbi8vICAgdHJ5IHtcclxuLy8gICAgIGNvbnN0IGRlY29kZWQgPSBqd3QudmVyaWZ5KHRva2VuLCBwcm9jZXNzLmVudi5KV1RfU0VDUkVUKTtcclxuLy8gICAgIHJlcS51c2VyID0gZGVjb2RlZDtcclxuLy8gICAgIC8vIGNvbnNvbGUubG9nKHJlcS51c2VyKVxyXG4vLyAgIH0gY2F0Y2ggKGVycikge1xyXG4vLyAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5zZW5kKFwiSW52YWxpZCBUb2tlblwiKTtcclxuLy8gICB9XHJcbi8vICAgcmV0dXJuIG5leHQoKTtcclxuXHJcbn1cclxubW9kdWxlLmV4cG9ydHM9dmVyaWZ5VG9rZW47XHJcbiJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTUEsR0FBRyxHQUFDQyxPQUFPLENBQUMsY0FBYyxDQUFDO0FBQ2pDLE1BQU1DLE1BQU0sR0FBQ0QsT0FBTyxDQUFDLFFBQVEsQ0FBQztBQUM5QkMsTUFBTSxDQUFDQyxNQUFNLEVBQUU7QUFFZixNQUFNQyxXQUFXLEdBQUMsT0FBTUMsR0FBRyxFQUFFQyxHQUFHLEVBQUVDLElBQUksS0FBRztFQUN6QztFQUNBO0VBQ0EsTUFBTUMsS0FBSyxHQUFHSCxHQUFHLENBQUNJLE9BQU8sQ0FBQ1QsR0FBRztFQUM3QixJQUFHUSxLQUFLLEVBQUM7SUFDTFIsR0FBRyxDQUFDVSxNQUFNLENBQUNGLEtBQUssRUFBQyxxQkFBcUIsRUFBQyxDQUFDRyxHQUFHLEVBQUNDLFlBQVksS0FBRztNQUN2RCxJQUFHRCxHQUFHLEVBQUM7UUFDSEwsR0FBRyxDQUFDTyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQztVQUFDLE9BQU8sRUFBQztRQUF3QixDQUFDLENBQUM7TUFDNUQ7TUFDQSxJQUFHRixZQUFZLEVBQUM7UUFDWEwsSUFBSSxFQUFFO01BQ1g7SUFDSixDQUFDLENBQUM7RUFDTixDQUFDLE1BQUk7SUFDREQsR0FBRyxDQUFDTyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQztNQUFDLFNBQVMsRUFBQztJQUF3QixDQUFDLENBQUM7RUFDN0Q7RUFDRDtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0FBRUEsQ0FBQzs7QUFDREMsTUFBTSxDQUFDQyxPQUFPLEdBQUNaLFdBQVcifQ==
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJtYXBwaW5ncyI6InN5SUFjaUI7QUFBQSwyRkFkakIsS0FBTUEsSUFBRywwQkFBQ0MsT0FBTyxDQUFDLGNBQWMsQ0FBQyxFQUNqQyxLQUFNQyxPQUFNLDBCQUFDRCxPQUFPLENBQUMsUUFBUSxDQUFDLDBCQUM5QkMsTUFBTSxDQUFDQyxNQUFNLEVBQUUseUJBRWYsS0FBTUMsWUFBVyxDQUFDLE1BQU1DLEdBQUcsQ0FBRUMsR0FBRyxDQUFFQyxJQUFJLEdBQUcseUJBQ3pDO0FBQ0E7QUFDQSxLQUFNQyxNQUFLLDBCQUFHSCxHQUFHLENBQUNJLE9BQU8sQ0FBQ1QsR0FBRywwQkFDN0IsR0FBR1EsS0FBSyxDQUFDLG9EQUNMUixHQUFHLENBQUNVLE1BQU0sQ0FBQ0YsS0FBSyxDQUFDLHFCQUFxQixDQUFDLENBQUNHLEdBQUcsQ0FBQ0MsWUFBWSxHQUFHLGlEQUN2RCxHQUFHRCxHQUFHLENBQUMsb0RBQ0hMLEdBQUcsQ0FBQ08sTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUMsQ0FBQyxPQUFPLENBQUMsd0JBQXdCLENBQUMsQ0FBQyxDQUM1RCwwREFDQSxHQUFHRixZQUFZLENBQUMscURBQ1hMLElBQUksRUFBRSxDQUNYLGtDQUNKLENBQUMsQ0FBQyxDQUNOLENBQUMsSUFBSSxxREFDREQsR0FBRyxDQUFDTyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQyxDQUFDLFNBQVMsQ0FBQyx3QkFBd0IsQ0FBQyxDQUFDLENBQzdELENBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBLENBQUMsMEJBQ0RDLE1BQU0sQ0FBQ0MsT0FBTyxDQUFDWixXQUFXIiwibmFtZXMiOlsiand0IiwicmVxdWlyZSIsImRvdGVudiIsImNvbmZpZyIsInZlcmlmeVRva2VuIiwicmVxIiwicmVzIiwibmV4dCIsInRva2VuIiwiY29va2llcyIsInZlcmlmeSIsImVyciIsImRlY29kZWR0b2tlbiIsInN0YXR1cyIsImpzb24iLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiJFOlxcYW5kZWxhXFxOZXcgQW5kZWxhXFxub2RlX21vbmdvX3R1dG9yaWFsXFxzcmNcXG1pZGRsZXdhcmVzXFwiLCJzb3VyY2VzIjpbInZlcmlmeVRva2VuLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGp3dD1yZXF1aXJlKFwianNvbndlYnRva2VuXCIpO1xyXG5jb25zdCBkb3RlbnY9cmVxdWlyZShcImRvdGVudlwiKTtcclxuZG90ZW52LmNvbmZpZygpO1xyXG5cclxuY29uc3QgdmVyaWZ5VG9rZW49YXN5bmMocmVxLCByZXMsIG5leHQpPT57XHJcbi8vIGNvbnN0IHRva2VuPXJlcS5oZWFkZXJzWyd0b2tlbiddXHJcbi8vY29uc3QgdG9rZW49YXV0aEhlYWRlciAmJiBhdXRoSGVhZGVyLnNwbGl0KCcnKVsxXVxyXG5jb25zdCB0b2tlbiA9IHJlcS5jb29raWVzLmp3dFxyXG5pZih0b2tlbil7XHJcbiAgICBqd3QudmVyaWZ5KHRva2VuLCdtaXJpbmRpdG9rZW5zZWNyZXRlJywoZXJyLGRlY29kZWR0b2tlbik9PntcclxuICAgICAgICBpZihlcnIpe1xyXG4gICAgICAgICAgICByZXMuc3RhdHVzKDQwMSkuanNvbih7XCJFcnJvclwiOlwiUGxlYXNlIExvZ2luIEZpcnN0ICEhIVwifSlcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYoZGVjb2RlZHRva2VuKXtcclxuICAgICAgICAgICAgIG5leHQoKVxyXG4gICAgICAgIH1cclxuICAgIH0pXHJcbn1lbHNle1xyXG4gICAgcmVzLnN0YXR1cyg0MDYpLmpzb24oe1wiTWVzc2FnZVwiOlwiUGxlYXNlIExvZ2luIEZpcnN0ICEhIVwifSlcclxuIH1cclxuLy8gaWYgKCF0b2tlbikge1xyXG4vLyAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5zZW5kKFwiQSB0b2tlbiBpcyByZXF1aXJlZCBmb3IgYXV0aGVudGljYXRpb25cIik7XHJcbi8vICAgfVxyXG4vLyAgIHRyeSB7XHJcbi8vICAgICBjb25zdCBkZWNvZGVkID0gand0LnZlcmlmeSh0b2tlbiwgcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCk7XHJcbi8vICAgICByZXEudXNlciA9IGRlY29kZWQ7XHJcbi8vICAgICAvLyBjb25zb2xlLmxvZyhyZXEudXNlcilcclxuLy8gICB9IGNhdGNoIChlcnIpIHtcclxuLy8gICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuc2VuZChcIkludmFsaWQgVG9rZW5cIik7XHJcbi8vICAgfVxyXG4vLyAgIHJldHVybiBuZXh0KCk7XHJcblxyXG59XHJcbm1vZHVsZS5leHBvcnRzPXZlcmlmeVRva2VuO1xyXG4iXX0=