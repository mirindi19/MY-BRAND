function cov_1ed3lubjti(){var path="E:\\andela\\New Andela\\node_mongo_tutorial\\src\\middlewares\\verifyToken.js";var hash="b310a05d9cb240743aedc5bb3c6e14319cc24cf1";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"E:\\andela\\New Andela\\node_mongo_tutorial\\src\\middlewares\\verifyToken.js",statementMap:{"0":{start:{line:1,column:12},end:{line:1,column:35}},"1":{start:{line:2,column:15},end:{line:2,column:32}},"2":{start:{line:3,column:0},end:{line:3,column:16}},"3":{start:{line:4,column:20},end:{line:18,column:1}},"4":{start:{line:5,column:16},end:{line:5,column:36}},"5":{start:{line:7,column:2},end:{line:9,column:3}},"6":{start:{line:8,column:4},end:{line:8,column:74}},"7":{start:{line:10,column:2},end:{line:16,column:3}},"8":{start:{line:11,column:20},end:{line:11,column:61}},"9":{start:{line:12,column:4},end:{line:12,column:23}},"10":{start:{line:13,column:4},end:{line:13,column:26}},"11":{start:{line:15,column:4},end:{line:15,column:49}},"12":{start:{line:17,column:2},end:{line:17,column:16}},"13":{start:{line:19,column:0},end:{line:19,column:29}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:4,column:20},end:{line:4,column:21}},loc:{start:{line:4,column:46},end:{line:18,column:1}},line:4}},branchMap:{"0":{loc:{start:{line:7,column:2},end:{line:9,column:3}},type:"if",locations:[{start:{line:7,column:2},end:{line:9,column:3}},{start:{line:7,column:2},end:{line:9,column:3}}],line:7}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0},f:{"0":0},b:{"0":[0,0]},inputSourceMap:{version:3,names:["jwt","require","dotenv","config","verifyToken","req","res","next","token","headers","status","send","decoded","verify","process","env","JWT_SECRET","user","console","log","err","module","exports"],sourceRoot:"E:\\andela\\New Andela\\node_mongo_tutorial\\src\\middlewares\\",sources:["verifyToken.js"],sourcesContent:["const jwt=require(\"jsonwebtoken\");\r\nconst dotenv=require(\"dotenv\");\r\ndotenv.config();\r\n\r\nconst verifyToken=async(req, res, next)=>{\r\nconst token=req.headers['token']\r\n//const token=authHeader && authHeader.split('')[1]\r\nif (!token) {\r\n    return res.status(403).send(\"A token is required for authentication\");\r\n  }\r\n  try {\r\n    const decoded = jwt.verify(token, process.env.JWT_SECRET);\r\n    req.user = decoded;\r\n    console.log(req.user)\r\n  } catch (err) {\r\n    return res.status(401).send(\"Invalid Token\");\r\n  }\r\n  return next();\r\n\r\n}\r\nmodule.exports=verifyToken;\r\n"],mappings:"AAAA,MAAMA,GAAG,GAACC,OAAO,CAAC,cAAc,CAAC;AACjC,MAAMC,MAAM,GAACD,OAAO,CAAC,QAAQ,CAAC;AAC9BC,MAAM,CAACC,MAAM,EAAE;AAEf,MAAMC,WAAW,GAAC,OAAMC,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAG;EACzC,MAAMC,KAAK,GAACH,GAAG,CAACI,OAAO,CAAC,OAAO,CAAC;EAChC;EACA,IAAI,CAACD,KAAK,EAAE;IACR,OAAOF,GAAG,CAACI,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC,wCAAwC,CAAC;EACvE;EACA,IAAI;IACF,MAAMC,OAAO,GAAGZ,GAAG,CAACa,MAAM,CAACL,KAAK,EAAEM,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC;IACzDX,GAAG,CAACY,IAAI,GAAGL,OAAO;IAClBM,OAAO,CAACC,GAAG,CAACd,GAAG,CAACY,IAAI,CAAC;EACvB,CAAC,CAAC,OAAOG,GAAG,EAAE;IACZ,OAAOd,GAAG,CAACI,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC,eAAe,CAAC;EAC9C;EACA,OAAOJ,IAAI,EAAE;AAEf,CAAC;AACDc,MAAM,CAACC,OAAO,GAAClB,WAAW"},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"b310a05d9cb240743aedc5bb3c6e14319cc24cf1"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1ed3lubjti=function(){return actualCoverage;};}return actualCoverage;}cov_1ed3lubjti();const jwt=(cov_1ed3lubjti().s[0]++,require("jsonwebtoken"));const dotenv=(cov_1ed3lubjti().s[1]++,require("dotenv"));cov_1ed3lubjti().s[2]++;dotenv.config();cov_1ed3lubjti().s[3]++;const verifyToken=async(req,res,next)=>{cov_1ed3lubjti().f[0]++;const token=(cov_1ed3lubjti().s[4]++,req.headers['token']);//const token=authHeader && authHeader.split('')[1]
cov_1ed3lubjti().s[5]++;if(!token){cov_1ed3lubjti().b[0][0]++;cov_1ed3lubjti().s[6]++;return res.status(403).send("A token is required for authentication");}else{cov_1ed3lubjti().b[0][1]++;}cov_1ed3lubjti().s[7]++;try{const decoded=(cov_1ed3lubjti().s[8]++,jwt.verify(token,process.env.JWT_SECRET));cov_1ed3lubjti().s[9]++;req.user=decoded;cov_1ed3lubjti().s[10]++;console.log(req.user);}catch(err){cov_1ed3lubjti().s[11]++;return res.status(401).send("Invalid Token");}cov_1ed3lubjti().s[12]++;return next();};cov_1ed3lubjti().s[13]++;module.exports=verifyToken;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJqd3QiLCJyZXF1aXJlIiwiZG90ZW52IiwiY29uZmlnIiwidmVyaWZ5VG9rZW4iLCJyZXEiLCJyZXMiLCJuZXh0IiwidG9rZW4iLCJoZWFkZXJzIiwic3RhdHVzIiwic2VuZCIsImRlY29kZWQiLCJ2ZXJpZnkiLCJwcm9jZXNzIiwiZW52IiwiSldUX1NFQ1JFVCIsInVzZXIiLCJjb25zb2xlIiwibG9nIiwiZXJyIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiRTpcXGFuZGVsYVxcTmV3IEFuZGVsYVxcbm9kZV9tb25nb190dXRvcmlhbFxcc3JjXFxtaWRkbGV3YXJlc1xcIiwic291cmNlcyI6WyJ2ZXJpZnlUb2tlbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBqd3Q9cmVxdWlyZShcImpzb253ZWJ0b2tlblwiKTtcclxuY29uc3QgZG90ZW52PXJlcXVpcmUoXCJkb3RlbnZcIik7XHJcbmRvdGVudi5jb25maWcoKTtcclxuXHJcbmNvbnN0IHZlcmlmeVRva2VuPWFzeW5jKHJlcSwgcmVzLCBuZXh0KT0+e1xyXG5jb25zdCB0b2tlbj1yZXEuaGVhZGVyc1sndG9rZW4nXVxyXG4vL2NvbnN0IHRva2VuPWF1dGhIZWFkZXIgJiYgYXV0aEhlYWRlci5zcGxpdCgnJylbMV1cclxuaWYgKCF0b2tlbikge1xyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAzKS5zZW5kKFwiQSB0b2tlbiBpcyByZXF1aXJlZCBmb3IgYXV0aGVudGljYXRpb25cIik7XHJcbiAgfVxyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBkZWNvZGVkID0gand0LnZlcmlmeSh0b2tlbiwgcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCk7XHJcbiAgICByZXEudXNlciA9IGRlY29kZWQ7XHJcbiAgICBjb25zb2xlLmxvZyhyZXEudXNlcilcclxuICB9IGNhdGNoIChlcnIpIHtcclxuICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuc2VuZChcIkludmFsaWQgVG9rZW5cIik7XHJcbiAgfVxyXG4gIHJldHVybiBuZXh0KCk7XHJcblxyXG59XHJcbm1vZHVsZS5leHBvcnRzPXZlcmlmeVRva2VuO1xyXG4iXSwibWFwcGluZ3MiOiJBQUFBLE1BQU1BLEdBQUcsR0FBQ0MsT0FBTyxDQUFDLGNBQWMsQ0FBQztBQUNqQyxNQUFNQyxNQUFNLEdBQUNELE9BQU8sQ0FBQyxRQUFRLENBQUM7QUFDOUJDLE1BQU0sQ0FBQ0MsTUFBTSxFQUFFO0FBRWYsTUFBTUMsV0FBVyxHQUFDLE9BQU1DLEdBQUcsRUFBRUMsR0FBRyxFQUFFQyxJQUFJLEtBQUc7RUFDekMsTUFBTUMsS0FBSyxHQUFDSCxHQUFHLENBQUNJLE9BQU8sQ0FBQyxPQUFPLENBQUM7RUFDaEM7RUFDQSxJQUFJLENBQUNELEtBQUssRUFBRTtJQUNSLE9BQU9GLEdBQUcsQ0FBQ0ksTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUMsd0NBQXdDLENBQUM7RUFDdkU7RUFDQSxJQUFJO0lBQ0YsTUFBTUMsT0FBTyxHQUFHWixHQUFHLENBQUNhLE1BQU0sQ0FBQ0wsS0FBSyxFQUFFTSxPQUFPLENBQUNDLEdBQUcsQ0FBQ0MsVUFBVSxDQUFDO0lBQ3pEWCxHQUFHLENBQUNZLElBQUksR0FBR0wsT0FBTztJQUNsQk0sT0FBTyxDQUFDQyxHQUFHLENBQUNkLEdBQUcsQ0FBQ1ksSUFBSSxDQUFDO0VBQ3ZCLENBQUMsQ0FBQyxPQUFPRyxHQUFHLEVBQUU7SUFDWixPQUFPZCxHQUFHLENBQUNJLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLGVBQWUsQ0FBQztFQUM5QztFQUNBLE9BQU9KLElBQUksRUFBRTtBQUVmLENBQUM7QUFDRGMsTUFBTSxDQUFDQyxPQUFPLEdBQUNsQixXQUFXIn0=
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJtYXBwaW5ncyI6Im83R0FnQkU7QUFBQSwyRkFoQkYsS0FBTUEsSUFBRywwQkFBQ0MsT0FBTyxDQUFDLGNBQWMsQ0FBQyxFQUNqQyxLQUFNQyxPQUFNLDBCQUFDRCxPQUFPLENBQUMsUUFBUSxDQUFDLDBCQUM5QkMsTUFBTSxDQUFDQyxNQUFNLEVBQUUseUJBRWYsS0FBTUMsWUFBVyxDQUFDLE1BQU1DLEdBQUcsQ0FBRUMsR0FBRyxDQUFFQyxJQUFJLEdBQUcseUJBQ3pDLEtBQU1DLE1BQUssMEJBQUNILEdBQUcsQ0FBQ0ksT0FBTyxDQUFDLE9BQU8sQ0FBQyxFQUNoQztBQUFBLHdCQUNBLEdBQUksQ0FBQ0QsS0FBSyxDQUFFLG9EQUNSLE1BQU9GLElBQUcsQ0FBQ0ksTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUMsd0NBQXdDLENBQUMsQ0FDdkUsMERBQ0EsR0FBSSxDQUNGLEtBQU1DLFFBQU8sMEJBQUdaLEdBQUcsQ0FBQ2EsTUFBTSxDQUFDTCxLQUFLLENBQUVNLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxVQUFVLENBQUMsMEJBQ3pEWCxHQUFHLENBQUNZLElBQUksQ0FBR0wsT0FBTywwQkFDbEJNLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDZCxHQUFHLENBQUNZLElBQUksQ0FBQyxDQUN2QixDQUFFLE1BQU9HLEdBQUcsQ0FBRSwwQkFDWixNQUFPZCxJQUFHLENBQUNJLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUM5QywwQkFDQSxNQUFPSixLQUFJLEVBQUUsQ0FFZixDQUFDLDBCQUNEYyxNQUFNLENBQUNDLE9BQU8sQ0FBQ2xCLFdBQVciLCJuYW1lcyI6WyJqd3QiLCJyZXF1aXJlIiwiZG90ZW52IiwiY29uZmlnIiwidmVyaWZ5VG9rZW4iLCJyZXEiLCJyZXMiLCJuZXh0IiwidG9rZW4iLCJoZWFkZXJzIiwic3RhdHVzIiwic2VuZCIsImRlY29kZWQiLCJ2ZXJpZnkiLCJwcm9jZXNzIiwiZW52IiwiSldUX1NFQ1JFVCIsInVzZXIiLCJjb25zb2xlIiwibG9nIiwiZXJyIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiRTpcXGFuZGVsYVxcTmV3IEFuZGVsYVxcbm9kZV9tb25nb190dXRvcmlhbFxcc3JjXFxtaWRkbGV3YXJlc1xcIiwic291cmNlcyI6WyJ2ZXJpZnlUb2tlbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBqd3Q9cmVxdWlyZShcImpzb253ZWJ0b2tlblwiKTtcclxuY29uc3QgZG90ZW52PXJlcXVpcmUoXCJkb3RlbnZcIik7XHJcbmRvdGVudi5jb25maWcoKTtcclxuXHJcbmNvbnN0IHZlcmlmeVRva2VuPWFzeW5jKHJlcSwgcmVzLCBuZXh0KT0+e1xyXG5jb25zdCB0b2tlbj1yZXEuaGVhZGVyc1sndG9rZW4nXVxyXG4vL2NvbnN0IHRva2VuPWF1dGhIZWFkZXIgJiYgYXV0aEhlYWRlci5zcGxpdCgnJylbMV1cclxuaWYgKCF0b2tlbikge1xyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAzKS5zZW5kKFwiQSB0b2tlbiBpcyByZXF1aXJlZCBmb3IgYXV0aGVudGljYXRpb25cIik7XHJcbiAgfVxyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBkZWNvZGVkID0gand0LnZlcmlmeSh0b2tlbiwgcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCk7XHJcbiAgICByZXEudXNlciA9IGRlY29kZWQ7XHJcbiAgICBjb25zb2xlLmxvZyhyZXEudXNlcilcclxuICB9IGNhdGNoIChlcnIpIHtcclxuICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuc2VuZChcIkludmFsaWQgVG9rZW5cIik7XHJcbiAgfVxyXG4gIHJldHVybiBuZXh0KCk7XHJcblxyXG59XHJcbm1vZHVsZS5leHBvcnRzPXZlcmlmeVRva2VuO1xyXG4iXX0=