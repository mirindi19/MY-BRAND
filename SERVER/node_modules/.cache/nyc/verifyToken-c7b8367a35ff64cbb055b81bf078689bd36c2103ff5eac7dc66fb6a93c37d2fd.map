{"version":3,"names":["jwt","require","dotenv","config","verifyToken","req","res","next","token","cookies","verify","err","decodedtoken","status","json","module","exports"],"sourceRoot":"E:\\andela\\New Andela\\node_mongo_tutorial\\src\\middlewares\\","sources":["verifyToken.js"],"sourcesContent":["const jwt=require(\"jsonwebtoken\");\r\nconst dotenv=require(\"dotenv\");\r\ndotenv.config();\r\n\r\nconst verifyToken=async(req, res, next)=>{\r\n// const token=req.headers['token']\r\n//const token=authHeader && authHeader.split('')[1]\r\nconst token = req.cookies.jwt\r\nif(token){\r\n    jwt.verify(token,'mirinditokensecrete',(err,decodedtoken)=>{\r\n        if(err){\r\n            res.status(401).json({\"Error\":\"Please Login First !!!\"})\r\n        }\r\n        if(decodedtoken){\r\n             next()\r\n        }\r\n    })\r\n}else{\r\n    res.status(406).json({\"Message\":\"Please Login First !!!\"})\r\n }\r\n// if (!token) {\r\n//     return res.status(404).send(\"A token is required for authentication\");\r\n//   }\r\n//   try {\r\n//     const decoded = jwt.verify(token, process.env.JWT_SECRET);\r\n//     req.user = decoded;\r\n//     // console.log(req.user)\r\n//   } catch (err) {\r\n//     return res.status(401).send(\"Invalid Token\");\r\n//   }\r\n//   return next();\r\n\r\n}\r\nmodule.exports=verifyToken;\r\n"],"mappings":"AAAA,MAAMA,GAAG,GAACC,OAAO,CAAC,cAAc,CAAC;AACjC,MAAMC,MAAM,GAACD,OAAO,CAAC,QAAQ,CAAC;AAC9BC,MAAM,CAACC,MAAM,EAAE;AAEf,MAAMC,WAAW,GAAC,OAAMC,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAG;EACzC;EACA;EACA,MAAMC,KAAK,GAAGH,GAAG,CAACI,OAAO,CAACT,GAAG;EAC7B,IAAGQ,KAAK,EAAC;IACLR,GAAG,CAACU,MAAM,CAACF,KAAK,EAAC,qBAAqB,EAAC,CAACG,GAAG,EAACC,YAAY,KAAG;MACvD,IAAGD,GAAG,EAAC;QACHL,GAAG,CAACO,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;UAAC,OAAO,EAAC;QAAwB,CAAC,CAAC;MAC5D;MACA,IAAGF,YAAY,EAAC;QACXL,IAAI,EAAE;MACX;IACJ,CAAC,CAAC;EACN,CAAC,MAAI;IACDD,GAAG,CAACO,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAC,SAAS,EAAC;IAAwB,CAAC,CAAC;EAC7D;EACD;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;AAEA,CAAC;;AACDC,MAAM,CAACC,OAAO,GAACZ,WAAW"}