function cov_1ed3lubjti(){var path="E:\\andela\\New Andela\\node_mongo_tutorial\\src\\middlewares\\verifyToken.js";var hash="b977ebc4707c6ec0ee771367e2674b42a51c65d7";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"E:\\andela\\New Andela\\node_mongo_tutorial\\src\\middlewares\\verifyToken.js",statementMap:{"0":{start:{line:1,column:12},end:{line:1,column:35}},"1":{start:{line:2,column:15},end:{line:2,column:32}},"2":{start:{line:3,column:0},end:{line:3,column:16}},"3":{start:{line:4,column:20},end:{line:18,column:1}},"4":{start:{line:5,column:16},end:{line:5,column:36}},"5":{start:{line:7,column:2},end:{line:9,column:3}},"6":{start:{line:8,column:4},end:{line:8,column:74}},"7":{start:{line:10,column:2},end:{line:16,column:3}},"8":{start:{line:11,column:20},end:{line:11,column:61}},"9":{start:{line:12,column:4},end:{line:12,column:23}},"10":{start:{line:15,column:4},end:{line:15,column:49}},"11":{start:{line:17,column:2},end:{line:17,column:16}},"12":{start:{line:19,column:0},end:{line:19,column:29}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:4,column:20},end:{line:4,column:21}},loc:{start:{line:4,column:46},end:{line:18,column:1}},line:4}},branchMap:{"0":{loc:{start:{line:7,column:2},end:{line:9,column:3}},type:"if",locations:[{start:{line:7,column:2},end:{line:9,column:3}},{start:{line:7,column:2},end:{line:9,column:3}}],line:7}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0},f:{"0":0},b:{"0":[0,0]},inputSourceMap:{version:3,names:["jwt","require","dotenv","config","verifyToken","req","res","next","token","headers","status","send","decoded","verify","process","env","JWT_SECRET","user","err","module","exports"],sourceRoot:"E:\\andela\\New Andela\\node_mongo_tutorial\\src\\middlewares\\",sources:["verifyToken.js"],sourcesContent:["const jwt=require(\"jsonwebtoken\");\r\nconst dotenv=require(\"dotenv\");\r\ndotenv.config();\r\n\r\nconst verifyToken=async(req, res, next)=>{\r\nconst token=req.headers['token']\r\n//const token=authHeader && authHeader.split('')[1]\r\nif (!token) {\r\n    return res.status(403).send(\"A token is required for authentication\");\r\n  }\r\n  try {\r\n    const decoded = jwt.verify(token, process.env.JWT_SECRET);\r\n    req.user = decoded;\r\n    // console.log(req.user)\r\n  } catch (err) {\r\n    return res.status(401).send(\"Invalid Token\");\r\n  }\r\n  return next();\r\n\r\n}\r\nmodule.exports=verifyToken;\r\n"],mappings:"AAAA,MAAMA,GAAG,GAACC,OAAO,CAAC,cAAc,CAAC;AACjC,MAAMC,MAAM,GAACD,OAAO,CAAC,QAAQ,CAAC;AAC9BC,MAAM,CAACC,MAAM,EAAE;AAEf,MAAMC,WAAW,GAAC,OAAMC,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAG;EACzC,MAAMC,KAAK,GAACH,GAAG,CAACI,OAAO,CAAC,OAAO,CAAC;EAChC;EACA,IAAI,CAACD,KAAK,EAAE;IACR,OAAOF,GAAG,CAACI,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC,wCAAwC,CAAC;EACvE;EACA,IAAI;IACF,MAAMC,OAAO,GAAGZ,GAAG,CAACa,MAAM,CAACL,KAAK,EAAEM,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC;IACzDX,GAAG,CAACY,IAAI,GAAGL,OAAO;IAClB;EACF,CAAC,CAAC,OAAOM,GAAG,EAAE;IACZ,OAAOZ,GAAG,CAACI,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC,eAAe,CAAC;EAC9C;EACA,OAAOJ,IAAI,EAAE;AAEf,CAAC;AACDY,MAAM,CAACC,OAAO,GAAChB,WAAW"},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"b977ebc4707c6ec0ee771367e2674b42a51c65d7"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1ed3lubjti=function(){return actualCoverage;};}return actualCoverage;}cov_1ed3lubjti();const jwt=(cov_1ed3lubjti().s[0]++,require("jsonwebtoken"));const dotenv=(cov_1ed3lubjti().s[1]++,require("dotenv"));cov_1ed3lubjti().s[2]++;dotenv.config();cov_1ed3lubjti().s[3]++;const verifyToken=async(req,res,next)=>{cov_1ed3lubjti().f[0]++;const token=(cov_1ed3lubjti().s[4]++,req.headers['token']);//const token=authHeader && authHeader.split('')[1]
cov_1ed3lubjti().s[5]++;if(!token){cov_1ed3lubjti().b[0][0]++;cov_1ed3lubjti().s[6]++;return res.status(403).send("A token is required for authentication");}else{cov_1ed3lubjti().b[0][1]++;}cov_1ed3lubjti().s[7]++;try{const decoded=(cov_1ed3lubjti().s[8]++,jwt.verify(token,process.env.JWT_SECRET));cov_1ed3lubjti().s[9]++;req.user=decoded;// console.log(req.user)
}catch(err){cov_1ed3lubjti().s[10]++;return res.status(401).send("Invalid Token");}cov_1ed3lubjti().s[11]++;return next();};cov_1ed3lubjti().s[12]++;module.exports=verifyToken;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJqd3QiLCJyZXF1aXJlIiwiZG90ZW52IiwiY29uZmlnIiwidmVyaWZ5VG9rZW4iLCJyZXEiLCJyZXMiLCJuZXh0IiwidG9rZW4iLCJoZWFkZXJzIiwic3RhdHVzIiwic2VuZCIsImRlY29kZWQiLCJ2ZXJpZnkiLCJwcm9jZXNzIiwiZW52IiwiSldUX1NFQ1JFVCIsInVzZXIiLCJlcnIiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiJFOlxcYW5kZWxhXFxOZXcgQW5kZWxhXFxub2RlX21vbmdvX3R1dG9yaWFsXFxzcmNcXG1pZGRsZXdhcmVzXFwiLCJzb3VyY2VzIjpbInZlcmlmeVRva2VuLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGp3dD1yZXF1aXJlKFwianNvbndlYnRva2VuXCIpO1xyXG5jb25zdCBkb3RlbnY9cmVxdWlyZShcImRvdGVudlwiKTtcclxuZG90ZW52LmNvbmZpZygpO1xyXG5cclxuY29uc3QgdmVyaWZ5VG9rZW49YXN5bmMocmVxLCByZXMsIG5leHQpPT57XHJcbmNvbnN0IHRva2VuPXJlcS5oZWFkZXJzWyd0b2tlbiddXHJcbi8vY29uc3QgdG9rZW49YXV0aEhlYWRlciAmJiBhdXRoSGVhZGVyLnNwbGl0KCcnKVsxXVxyXG5pZiAoIXRva2VuKSB7XHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDMpLnNlbmQoXCJBIHRva2VuIGlzIHJlcXVpcmVkIGZvciBhdXRoZW50aWNhdGlvblwiKTtcclxuICB9XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGRlY29kZWQgPSBqd3QudmVyaWZ5KHRva2VuLCBwcm9jZXNzLmVudi5KV1RfU0VDUkVUKTtcclxuICAgIHJlcS51c2VyID0gZGVjb2RlZDtcclxuICAgIC8vIGNvbnNvbGUubG9nKHJlcS51c2VyKVxyXG4gIH0gY2F0Y2ggKGVycikge1xyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5zZW5kKFwiSW52YWxpZCBUb2tlblwiKTtcclxuICB9XHJcbiAgcmV0dXJuIG5leHQoKTtcclxuXHJcbn1cclxubW9kdWxlLmV4cG9ydHM9dmVyaWZ5VG9rZW47XHJcbiJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTUEsR0FBRyxHQUFDQyxPQUFPLENBQUMsY0FBYyxDQUFDO0FBQ2pDLE1BQU1DLE1BQU0sR0FBQ0QsT0FBTyxDQUFDLFFBQVEsQ0FBQztBQUM5QkMsTUFBTSxDQUFDQyxNQUFNLEVBQUU7QUFFZixNQUFNQyxXQUFXLEdBQUMsT0FBTUMsR0FBRyxFQUFFQyxHQUFHLEVBQUVDLElBQUksS0FBRztFQUN6QyxNQUFNQyxLQUFLLEdBQUNILEdBQUcsQ0FBQ0ksT0FBTyxDQUFDLE9BQU8sQ0FBQztFQUNoQztFQUNBLElBQUksQ0FBQ0QsS0FBSyxFQUFFO0lBQ1IsT0FBT0YsR0FBRyxDQUFDSSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQyx3Q0FBd0MsQ0FBQztFQUN2RTtFQUNBLElBQUk7SUFDRixNQUFNQyxPQUFPLEdBQUdaLEdBQUcsQ0FBQ2EsTUFBTSxDQUFDTCxLQUFLLEVBQUVNLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxVQUFVLENBQUM7SUFDekRYLEdBQUcsQ0FBQ1ksSUFBSSxHQUFHTCxPQUFPO0lBQ2xCO0VBQ0YsQ0FBQyxDQUFDLE9BQU9NLEdBQUcsRUFBRTtJQUNaLE9BQU9aLEdBQUcsQ0FBQ0ksTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUMsZUFBZSxDQUFDO0VBQzlDO0VBQ0EsT0FBT0osSUFBSSxFQUFFO0FBRWYsQ0FBQztBQUNEWSxNQUFNLENBQUNDLE9BQU8sR0FBQ2hCLFdBQVcifQ==
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJtYXBwaW5ncyI6IjJ6R0FnQkU7QUFBQSwyRkFoQkYsS0FBTUEsSUFBRywwQkFBQ0MsT0FBTyxDQUFDLGNBQWMsQ0FBQyxFQUNqQyxLQUFNQyxPQUFNLDBCQUFDRCxPQUFPLENBQUMsUUFBUSxDQUFDLDBCQUM5QkMsTUFBTSxDQUFDQyxNQUFNLEVBQUUseUJBRWYsS0FBTUMsWUFBVyxDQUFDLE1BQU1DLEdBQUcsQ0FBRUMsR0FBRyxDQUFFQyxJQUFJLEdBQUcseUJBQ3pDLEtBQU1DLE1BQUssMEJBQUNILEdBQUcsQ0FBQ0ksT0FBTyxDQUFDLE9BQU8sQ0FBQyxFQUNoQztBQUFBLHdCQUNBLEdBQUksQ0FBQ0QsS0FBSyxDQUFFLG9EQUNSLE1BQU9GLElBQUcsQ0FBQ0ksTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUMsd0NBQXdDLENBQUMsQ0FDdkUsMERBQ0EsR0FBSSxDQUNGLEtBQU1DLFFBQU8sMEJBQUdaLEdBQUcsQ0FBQ2EsTUFBTSxDQUFDTCxLQUFLLENBQUVNLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxVQUFVLENBQUMsMEJBQ3pEWCxHQUFHLENBQUNZLElBQUksQ0FBR0wsT0FBTyxDQUNsQjtBQUNGLENBQUUsTUFBT00sR0FBRyxDQUFFLDBCQUNaLE1BQU9aLElBQUcsQ0FBQ0ksTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUMsZUFBZSxDQUFDLENBQzlDLDBCQUNBLE1BQU9KLEtBQUksRUFBRSxDQUVmLENBQUMsMEJBQ0RZLE1BQU0sQ0FBQ0MsT0FBTyxDQUFDaEIsV0FBVyIsIm5hbWVzIjpbImp3dCIsInJlcXVpcmUiLCJkb3RlbnYiLCJjb25maWciLCJ2ZXJpZnlUb2tlbiIsInJlcSIsInJlcyIsIm5leHQiLCJ0b2tlbiIsImhlYWRlcnMiLCJzdGF0dXMiLCJzZW5kIiwiZGVjb2RlZCIsInZlcmlmeSIsInByb2Nlc3MiLCJlbnYiLCJKV1RfU0VDUkVUIiwidXNlciIsImVyciIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6IkU6XFxhbmRlbGFcXE5ldyBBbmRlbGFcXG5vZGVfbW9uZ29fdHV0b3JpYWxcXHNyY1xcbWlkZGxld2FyZXNcXCIsInNvdXJjZXMiOlsidmVyaWZ5VG9rZW4uanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3Qgand0PXJlcXVpcmUoXCJqc29ud2VidG9rZW5cIik7XHJcbmNvbnN0IGRvdGVudj1yZXF1aXJlKFwiZG90ZW52XCIpO1xyXG5kb3RlbnYuY29uZmlnKCk7XHJcblxyXG5jb25zdCB2ZXJpZnlUb2tlbj1hc3luYyhyZXEsIHJlcywgbmV4dCk9PntcclxuY29uc3QgdG9rZW49cmVxLmhlYWRlcnNbJ3Rva2VuJ11cclxuLy9jb25zdCB0b2tlbj1hdXRoSGVhZGVyICYmIGF1dGhIZWFkZXIuc3BsaXQoJycpWzFdXHJcbmlmICghdG9rZW4pIHtcclxuICAgIHJldHVybiByZXMuc3RhdHVzKDQwMykuc2VuZChcIkEgdG9rZW4gaXMgcmVxdWlyZWQgZm9yIGF1dGhlbnRpY2F0aW9uXCIpO1xyXG4gIH1cclxuICB0cnkge1xyXG4gICAgY29uc3QgZGVjb2RlZCA9IGp3dC52ZXJpZnkodG9rZW4sIHByb2Nlc3MuZW52LkpXVF9TRUNSRVQpO1xyXG4gICAgcmVxLnVzZXIgPSBkZWNvZGVkO1xyXG4gICAgLy8gY29uc29sZS5sb2cocmVxLnVzZXIpXHJcbiAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLnNlbmQoXCJJbnZhbGlkIFRva2VuXCIpO1xyXG4gIH1cclxuICByZXR1cm4gbmV4dCgpO1xyXG5cclxufVxyXG5tb2R1bGUuZXhwb3J0cz12ZXJpZnlUb2tlbjtcclxuIl19