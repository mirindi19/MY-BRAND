<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="Admin-style.css"/>
    <title>PostAdmin</title>
</head>
<body>
    <div class="wrapper">
           <div class="sidebar">
               <div class="profile">
                   <img src="./pictures/Mirindi.jpg" alt="profile_picture"></img>
                   <h3>Mirindi Saidi</h3>
                   <p>Admin</p>
            </div>
            <ul>
                <li>
                    <a href="">
                        <span class="item" >Sign up view</span>
                    </a>
                </li>
                <li>
                    <a href="viewMessage.html">
                        <span class="item" >Message</span>
                    </a>
                </li>
                <li>
                    <a href="AdminAddSkill.html">
                        <span class="item">Add Skill</span>
                    </a>
                </li>
                <li>
                    <a href="" class="active">
                        <span class="item">Blog</span>
                    </a>
                </li>           
  </ul>
          </div>
           
          <div class="section">
            <div class="top_navbar">
                <div class="hamburger">
                   <a href="index.html" class="btnTopNavbar">Logout</a>
                </div>
            </div>
             
        </div>
        <main>
            <div class="wrapper-table">
       <div class="Table-div-response">
        <a href="AdminAddBlog.html" class="btnAction">Add Blog</a>
            <table class="display-Table">
                <tr> 
                    <th>Title</th>
                    <th>Date</th>
                    <th>content</th>
                    <th>Picture</th>
                    <th>Action</th>
                </tr>
                
                <tbody id="storeList">
                    
                </tbody> 
            </table>
            </div>
                </div>
        </main>
        <script src="main.js"></script>
        <script>window.onload=displayBlogAdim()</script> 
        <script>
              const token=localStorage.getItem("loginuser")
        let headers
        if (token) {
      headers = {
        "Content-Type": "application/json",
        token: `${token}`,
      };
    } else {
      headers = {
        "Content-Type": "application/json",
      };
    }
        // console.log("token",token);
        fetch("https://my-brand-production-e42e.up.railway.app/blog",{headers:headers}).then((data)=>{
            return data.json();
        }).then((objectData)=>{
            // console.log(objectData);
            let tableData="";
            objectData.data.map((values)=>{
                tableData+= ` <tr key=${values._id}>
                    <td>${values.title}</td>
                    <td>${values.date}</td>
                    <td>${values.content}</td>
                       <td><img src="${values.image}"/></td>
                       <td><button onclick="logout()">Delete</button></td>
                    </tr>`;
            });
            document.getElementById("storeList").innerHTML=tableData;
        })
        </script>

        <script>
            function logout(){
                // const user = JSON.parse(localStorage.getItem("loginuser"))
//  var myHeaders = new Headers();
// myHeaders.append("token",`${user.token}`);
const token=localStorage.getItem("loginuser")
        let headers
        if (token) {
      headers = {
        "Content-Type": "application/json",
        token: `${token}`,
      };
    } else {
      headers = {
        "Content-Type": "application/json",
      };
    }
var requestOptions = {
  method: 'DELETE',
  headers: headers,
  redirect: 'follow'
};

fetch("https://my-brand-production-e42e.up.railway.app/blog/63f5ea35d80ab65eb83d83cb", requestOptions)
  .then(response => response.text())
  .then(result => console.log(result))
  .catch(error => console.log('error', error));
            }
        </script>
</body>
</html>